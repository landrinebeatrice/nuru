$(document).ready(function(){
  //nouvelle facture
  $(document).on('click', '.facture', function(){
      var idStudent = $(this).attr("id");
 	  //mois Ã  payer
        var ids = idStudent;
        $.post('./processing/update/monthStudent.php',{ids:ids},function(datas){
        	$('#moisE').html(datas);
      	});

        $.post('./processing/update/feeStudent.php',{idStudent:idStudent},function(data){
        	$('#infoFees').html(data);
      	});
      
      $('#idStd').val(idStudent);
      $('#formFacture').modal('show');
  });

    //recuperation des donnees de l'eleve et ajout des values au champ du modal
    $(document).on('click', '.detailStudent', function(){
      var user_id = $(this).attr("id");
      $.ajax({
        url:"./processing/update/detail_student.php",
        method:"POST",
        data:{user_id:user_id},
        dataType:"json",
        success:function(data){
          $('#nms').html(data.name_student);
          $('#pstns').html(data.middlename_student);
          $('#pns').html(data.lastname_student);
          $('#tls').html("+243"+data.tel_student);
          $('#ln').html(data.lieu_naissance);
          $('#dn').html(data.date_naissance);
          if(data.arret_bus == ""){
            $('#ab').html('--R.A.S--');
          }else{
            $('#ab').html(data.arret_bus);
          }
          $('#ft').html(data.frais_transport+" USD");
          if(data.sexe == "F"){
            $('#sx').html("FEMININ");
          }else{
            $('#sx').html("MASCULIN");
          }
          $('#di').html(data.date_inscription)

          $('#nmp').html(data.ng);
          $('#cp').html(data.cp);
          $('#tlp').html(data.tlp);
          $('#emp').html(data.email);
          $('#qrt').html(data.qrt);
          $('#cmn').html(data.cmn);
  
          $('#detail_eleve').modal('show');
        }
      })
    });

          //recuperation des donnees de la section
    $(document).on('click', '.edit_frais', function(){
      var fee_id = $(this).attr("id");
      //alert(id_parent);
      $.ajax({
        url:"./processing/update/update_fees.php",
        method:"POST",
        data:{fee_id:fee_id},
        dataType:"json",
        success:function(data){

          $('#libele').val(data.libele);
          $('#montant').val(data.montant);
          $('#section').val(data.section_id).select();
          $('#id_frais').val(data.id_frais);
         
          $('#fees_update').modal('show');
         
        }
      })
  });

    //recuperation des donnees de la section
    $(document).on('click', '.edit_parent', function(){
      var parent_id = $(this).attr("id");
      //alert(id_parent);
      $.ajax({
        url:"./processing/update/update_parent.php",
        method:"POST",
        data:{parent_id:parent_id},
        dataType:"json",
        success:function(data){

          $('#id_parent').val(data.id_parent);
          $('#parent_lastname').val(data.lastname);
          $('#parent_name').val(data.name_p);
          $('#parent_tel1').val(data.tel1);
          $('#parent_tel2').val(data.tel2);
          $('#parent_email').val(data.email);
          $('#quartier').val(data.quartier);
          $('#commune').val(data.commune);
         
          $('#editer_parent').modal('show');
         
        }
      })
    });

     //recuperation des donnees de la section
    $(document).on('click', '.edit_section', function(){
      var id_section = $(this).attr("id");
      $.ajax({
        url:"./processing/update/update_section.php",
        method:"POST",
        data:{id_section:id_section},
        dataType:"json",
        success:function(data)
        {
          $('#name_section').val(data.name_section);
          $('#id_section').val(data.id_section);
          $('#libFraisIns').val(data.libFraisIns);
          $('#montFraisIns').val(data.montFraisIns);
          $('#libFraisMens').val(data.libFraisMens);
          $('#montFraisMens').val(data.montFraisMens);
          $('#idFraisIns').val(data.idFraisIns);
          $('#idFraisMens').val(data.idFraisMens);
         
          $('#section_update').modal('show');
         
        }
      })
  });

    //recuperation des donnees de la section
    $(document).on('click', '.litige', function(){
      var id_student = $(this).attr("id");
      $.ajax({
        url:"./processing/update/litige.php",
        method:"POST",
        data:{id_student:id_student},
        dataType:"json",
        success:function(data)
        {
          $('#motif').val(data.motif);
          $('#total').val(data.reste);
          $('#idStudent').val(data.idStudent);
          $('#numFac').val(data.numFac);

          $('#mot').html(data.motif);
          $('#tot').html(data.reste);
         
          $('#litige').modal('show');
          restetotal();
        }
      })
  });

    function restetotal(){
      var t = document.getElementById('total').value;
      var n = document.getElementById('montantPayer').value;

      document.getElementById('rest').value = t-n;
      document.getElementById('reste').value = t-n;
    }
    setInterval(restetotal,1);
});